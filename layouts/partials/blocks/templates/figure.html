{{ $lazy := partial "func/isLazyImage" (dict "first" .first) }}

{{ $class := partial "func/GetColClass" .grid }}
{{ $columnWanted := 12 }}
{{ if eq .grid "small" }}
  {{ $columnWanted = 6 }}
{{ else if eq .grid "medium" }}
  {{ $columnWanted = 8 }}
{{ else if eq .grid "large" }}
  {{ $columnWanted = 10 }}
{{ end }}

<section class="block-figure{{ with .background }} block-bg{{ end }}">
  <div class="container">

    {{ if $class }}
    <div class="row">
      <div class="{{ $class }}">
    {{ end }}

        {{ with .figure }}
          {{ $src := .src | default false }}
          {{ $alt := .alt | default false }}
          {{ $legend := .legend | default false }}
          {{ $credit := .credit | default false }}
          {{ $desktop := site.Params.container.desktop | default false }}
          {{ $mobile := site.Params.image.mobile | default false }}
          {{ if $desktop }}
            {{ $width := partial "func/GetColumnWidth" (dict "column" $columnWanted) }}
            {{ $desktop = printf "%sx" (string $width) }}
          {{ end }}
          {{ partial "commons/figure" (dict
            "src" $src 
            "alt" $alt 
            "desktop" $desktop
            "mobile" $mobile
            "lazy" $lazy 
            "legend" $legend 
            "credit" $credit
            ) }}
        {{ end }}
    
    {{ if $class }}
      </div>
    </div>
    {{ end }}

  </div>
</section>